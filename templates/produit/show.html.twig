
{% extends 'base.html.twig' %}

{% block title %}Produit{% endblock %}
.product-card img {
    max-height: 200px;
    object-fit: cover;
}

{% block body %}
<section id="products">
    <div class="container">
        <h2>Nos produits</h2>

        <div class="row">
            {% for product in products %}
                <div class="col-md-4">
                    <div class="product-card">
                       <img src="{{ asset('/uploads/produits/' ~ product.image) }}" alt="product-image" class="img-fluid">
                        <h3>{{ product.name }}</h3>
                        <p>{{ product.description }}</p>
                        <p><strong>{{ product.price }} TND</strong></p>
                   
                      <form action="{{ path('add_to_cart', {'id': product.id}) }}" method="POST">
                      <button type="submit" class="cart-btn">
                      <i class="fas fa-shopping-cart"></i> Add to Cart
                      </button>
                      </form>

                    </div>
                </div>
            {% endfor %}
        </div>
    </div>
</section>
{% block javascripts %}
    <script>
        document.addEventListener("DOMContentLoaded", function () {
            document.querySelectorAll(".product-image a").forEach(link => {
                link.addEventListener("click", function (event) {
                    event.preventDefault();
                    
                    let productId = this.getAttribute("data-id");

                    fetch(`/product/details/${productId}`)
                        .then(response => response.json())
                        .then(data => {
                            if (data.error) {
                                alert("Product not found!");
                            } else {
                                document.getElementById("modalTitle").innerText = data.name;
                                document.getElementById("modalImage").src = data.image;
                                document.getElementById("modalDescription").innerText = data.description;
                                document.getElementById("modalPrice").innerText = data.price + " TND";
                                
                                // Afficher la modal Bootstrap
                                $("#productModal").modal("show");
                            }
                        })
                        .catch(error => console.error("Error fetching product details:", error));
                });
            });
        });
    </script>
    
{% endblock %}


{% endblock %}
